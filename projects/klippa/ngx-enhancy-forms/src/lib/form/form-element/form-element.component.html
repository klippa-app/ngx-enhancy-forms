<ng-template #errorRef>
	<div *ngIf="shouldShowErrorMessages() && getErrorToShow()" class="errorContainer" [ngClass]="{hasCaption: caption || captionRef, 'd30-70': spaceDistribution === '30-70', 'd34-66': spaceDistribution === '34-66'}" [klpWithTooltip]="!errorMessageAsTooltip && getErrorLocation() === 'rightOfCaption'">
		<div *ngIf="showDefaultError('min')">{{substituteParameters(getErrorMessage("min"), {min: attachedControl.errors.min.min})}}</div>
		<div *ngIf="showDefaultError('max')">{{substituteParameters(getErrorMessage("max"), {max: attachedControl.errors.max.max})}}</div>
		<div *ngIf="showDefaultError('required')">{{getErrorMessage("required")}}</div>
		<div *ngIf="showDefaultError('email')">{{getErrorMessage("email")}}</div>
		<div *ngIf="showDefaultError('minlength')">{{substituteParameters(getErrorMessage("minLength"), {minLength: attachedControl.errors.minlength.requiredLength})}}</div>
		<div *ngIf="showDefaultError('maxlength')">{{substituteParameters(getErrorMessage("maxLength"), {maxLength: attachedControl.errors.maxlength.requiredLength})}}</div>
		<div *ngIf="showDefaultError('pattern')">{{getErrorMessage("pattern")}}</div>
		<div *ngIf="showDefaultError('MatchPassword')">{{getErrorMessage("matchPassword")}}</div>
		<div *ngIf="showDefaultError('date')">{{getErrorMessage("date")}}</div>
		<div *ngIf="showDefaultError('message')">{{attachedControl.errors.message.value}}</div>
		<div [ngTemplateOutlet]="getCustomErrorHandler(getErrorToShow())?.templateRef"></div>
	</div>
</ng-template>

<ng-container *ngIf="direction === 'horizontal' && !errorMessageAsTooltip" [ngTemplateOutlet]="errorRef"></ng-container>

<div class="componentContainer" [ngClass]="{hasCaption: caption || captionRef, vertical: direction === 'vertical', reverseOrder: swapInputAndCaption}" #internalComponentRef>
	<div class="caption" *ngIf="caption || captionRef"
		[ngClass]="{
			hasErrors: getErrorToShow() && attachedControl.touched,
			percentageSpacing: captionSpacing === 'percentages',
			'd30-70': spaceDistribution === '30-70',
			'd34-66': spaceDistribution === '34-66',
			withErrorRightOfCaption: getErrorLocation() === 'rightOfCaption'
		}"
	>
		<div *ngIf="captionRef" class="captionRefContainer">
			<ng-container [ngTemplateOutlet]="captionRef"></ng-container>
			<div *ngIf="isRequired()">&nbsp;*</div>
		</div>
		<div *ngIf="!captionRef" class="captionText">{{caption}}<span *ngIf="isRequired()">&nbsp;*</span></div>
		<div class="rightOfCaptionError">
			<ng-container *ngIf="direction === 'vertical' && getErrorLocation() === 'rightOfCaption' && !errorMessageAsTooltip" [ngTemplateOutlet]="errorRef"></ng-container>
		</div>
	</div>
	<ng-container *ngIf="direction === 'vertical' && getErrorLocation() === 'belowCaption' && !errorMessageAsTooltip" [ngTemplateOutlet]="errorRef"></ng-container>
	<div class="inputContainer" [ngClass]="{
		percentageSpacing: captionSpacing === 'percentages',
		'd30-70': spaceDistribution === '30-70',
		'd34-66': spaceDistribution === '34-66'
	}">
		<ng-container *ngIf="errorMessageAsTooltip && shouldShowErrorMessages() && getErrorToShow()">
			<div class="errorTooltipTriangle"></div>
			<div class="errorTooltipTriangleWhite"></div>
			<div class="errorTooltip">
				<ng-container [ngTemplateOutlet]="errorRef"></ng-container>
			</div>
		</ng-container>
		<ng-content></ng-content>
	</div>
</div>
